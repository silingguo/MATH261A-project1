---
title: "The Relationship Between the Number of New COVID-19 Cases and the Number of Patients on Ventilators"
subtitle: "Simple Linear Model Project"
author: "Siling Guo"
thanks: "Project repository available at: [https://github.com/silingguo/MATH261A-project-template](https://github.com/silingguo/MATH261A-project1)."
date: 2025-09-23
date-format: long
abstract: " This study explores the relationship between the number of new COVID-19 cases and the number of patients on ventilators. A simple linear regression model was established based on the data provided by the County of Santa Clara Public Health Department between 2020-03-27 and 2021-05-23. The model shows a significant positive correlation between the two variables; there was an expected increase of 0.97 ventilator patients for each additional COVID-19 case ($\\beta_1$=0.97, p<0.001 ). The number of new COVID-19 cases is a significant predictor of ventilator demand ( R Squared=0.62 ). This model can help predict the potential demand for medical devices during a pandemic."
format: pdf
bibliography: references.bib
number-sections: true

---

```{r}
#| include: false 
#| warning: false
#| message: false

library(dplyr)
library(lubridate)
library(ggplot2)
library(gt)
library(broom)
library(readr)
library(flextable)
COVID_19_hospitalizations_by_date_20250917 <- read_csv("../data/COVID-19_hospitalizations_by_date_20250917.csv")
View(COVID_19_hospitalizations_by_date_20250917)
```

# Introduction

The 2020-2023 COVID-19 pandemic magnified the imbalance between the limited amount of medical resources and the surging number of new incoming medical patients worldwide. The pandemic significantly disrupted the health service system[@filip_global_2022], especially in resource-limited countries. Even though the COVID-19 pandemic has ended, understanding the correlation between new COVID-19 cases and the number of patients requiring ventilators is useful for analyzing the potential demand for medical devices during a pandemic. This project aims to analyze the impact of the number of COVID-19 cases on ventilator usage using the linear regression model based on the data set published by the Count of Santa Clara Public Health Department from 2020-03-27 to 2021-05-23[@noauthor_covid-19_nodate]. First, we will discuss the research background and proposal followed by the usage and processing of the data. Next, we will explain the setup and validation of the model and its limitations before showing the results with relevant tables and graphs along with our conclusion.Through analysis, we found a significant positive correlation between the increase in the number of COVID-19 cases and the growth in the number of patients requiring ventilators.

# Data {#sec-data}

The observational unit in this study is the daily hospital data from 2023/3/27-2021/5/23, provided by the County of Santa Clara Public Health Department. The sample size is 423 days. The two key variables are the number of new COVID-19 cases and the number of patients on ventilators, which are continuous variables measured in people. The data is generated by the County of Santa Clara Public Health Department and posted on the County of Santa Clara Open Data Portal. There are no missing values in the core variables. Besides, there are a small number of outliers that were retained as they likely reflect peak pandemic conditions. Overall, the data are clean, so the only processing performed was converting date strings into a datetime format. According to the data summary (@tbl-summary-table), the daily average number of new COVID-19 cases was 28.4 with a standard deviation of 28 and a maximum of 124. This data has significant fluctuations. The daily average number of patients using ventilators is 179.7 with a standard deviation of 34.5. This data has smaller fluctuations. Overall, the trend in the number of patients using ventilators is generally consistent with the trend in the number of new COVID-19 cases(@fig-tren-plot). Furthermore, due to the unique course of the COVID-19 disease, not all confirmed patients require ventilators immediately, resulting in a delayed peak in demand for medical equipment. We can observe this time delay in the data. This trend allows us to predict demand for medical equipment.


```{r tbl-summary-table}
#| echo: false
#| warning: false
#| message: false
#| tbl-cap: "Data Summary of Covid-19 New Cases and Number of patients on ventilators"
#| label: tbl-summary-table


hos_data <- COVID_19_hospitalizations_by_date_20250917
hos_data <- hos_data %>% 
  dplyr::filter(!is.na(covid_new)) %>%
  mutate(
    hos_Date = as.Date(Date)
)
summary_stat <- hos_data %>%
  dplyr::summarise(
    covid_new_mean = mean(covid_new),
    vents_pts_mean = mean(vents_pts),
    covid_new_std = sd(covid_new),
    vents_pts_std = sd(vents_pts),
    covid_new_max = max(covid_new),
    vents_pts_max = max(vents_pts),
    covid_new_min = min(covid_new),
    vents_pts_min = min(vents_pts),
    
)
colnames(summary_stat) <- c(
  "Mean \n (covid_new)",
  "Mean \n(vents_pts)",
  "SD \n (covid_new)",
  "SD \n(vents_pts)",
  "Max \n (covid_new)",
  "Max \n(vents_pts)",
  "Min \n (covid_new)",
  "Min \n(vents_pts)"
)


data_summary_table <- flextable(summary_stat) %>%
  add_header_lines(values = "Data Summary of Covid-19 New Cases and Number of patients on ventilators")%>%
  set_table_properties(width = 1, layout = "autofit") %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  fontsize(size = 7, part = "all") %>%
  bold(part = "header")

data_summary_table

```


```{r fig-tren-plot}
#| echo: false
#| warning: false
#| message: false
#| fig-cap: "Trends Over Time"
#| label: fig-tren-plot

ggplot(hos_data,aes(x = Date))+
  geom_line(aes(y = covid_new, group = 1, color = "covid_new"), linewidth = 0.5)+
  geom_line(aes(y = vents_pts, group = 2, color = "vents_pts"), linewidth = 0.5)+
  scale_color_manual(
    values = c("covid_new" = "red", "vents_pts" = "green")) +
  labs(
    title = "Trends Over Time",
    subtitle = "2020/3/27-2021/5/23",
    x = "Date",
    y = "count"
   ) +
  theme_minimal() 
```

\newpage

# Methods


```{r fig-quan-plot}
#| echo: false
#| warning: false
#| message: false
#| fig-cap: "Quantile-quantile plot of residuals"
#| label: fig-quan-plot


hos_data <- COVID_19_hospitalizations_by_date_20250917
hos_data <- hos_data %>% 
  dplyr::filter(!is.na(covid_new)) %>%
  mutate(
    hos_Date = as.Date(Date)
)

covid_vents_mode <- lm(vents_pts~covid_new, data = hos_data)

mod_residuals <- residuals(covid_vents_mode)
mod_fitted <- fitted(covid_vents_mode)
ggplot(data.frame(residual = mod_residuals), aes(sample = residual)) +
  geom_qq() +
  geom_qq_line() +
  xlab("Theoretical quantile (Normal distribution)") +
  ylab("Sample quantile") + 
  ggtitle("Quantile-quantile plot of residuals")+
 theme_minimal() 
```


The number of new COVID-19 cases and the number of patients on ventilators are continuous variables. According to the trend chart of the data, it suggests a potential linear correlation between two variables. Therefore, we apply a simple linear regression model. $y_i = \beta_0 + \beta_1 x_i + \varepsilon_i$ Here, $y_i$ covid_new: The number of new COVID-19 cases on a given day $X_i$(Vents_pts): The number of patients on ventilators on a given day $\beta_0$(intercept):The average number of patients on ventilators when there are no new COVID-19 cases. $\beta_1$ (slope): The expected change in the number of patients using ventilators for each additional new COVID-19 case. In this model, we use the ordinary least squares (OLS) method to estimate the parameters, and apply the lm() function in R to fit the model. The OLS method assumes that the error term $\varepsilon_i$ follows a normal distribution. The QQ-Plot (@fig-quan-plot)indicates that the majority of the residuals closely align with the reference line. A few data points fall below the expected quantiles on the left, while a few data points fall above the expected quantiles. This suggests that there might be outliers. In general, the error terms are approximately normally distributed.


# Results

@fig-model-plot indicates that the number of patients on ventilators becomes increasingly dispersed as the number of new COVID-19 cases rises, and the model demonstrates a moderate fit.From the data summary((@tbl-model-table)), we find F(1, 401) = 655.6, p-value: \< .001, and estimate of covid_new = 0.97, indicating that the linear regression model is highly significant, and the predictor variable (x) can explain the variation in the dependent variable (y). Multiple R-squared: 0.6205 and Adjusted R-squared: 0.6195 indicate a model fit of approximately 60%. This result is likely due to the failure to account for the lag effect in ventilator usage, the proportion of severe COVID-19 cases, and seasonal factors, which can all affect ventilator use.
This study’s results show that the number of newly confirmed COVID-19 cases is a key factor influencing the demand in ventilator usage. Specifically, for every new COVID-19 patient during this time period, there is an expected increase of 0.97 ventilator patients. This finding provides insights into the relationship between epidemics the medical equipment demand, contributing to better planning for the stockpiling, deploying and resource planning of medical equipment during epidemics. We can improve the model’s fit by adding in additional unaccounted factors.

```{r fig-model-plot}
#| echo: false
#| warning: false
#| message: false
#| fig-cap: "Number of patients on ventilators vs. Number of new COVID cases"
#| label: fig-model-plot

covid_vents_mode <- lm(vents_pts~covid_new, data = hos_data)
ggplot(covid_vents_mode, aes(x = covid_new,y = vents_pts) )+
  geom_point(size = 1) +
  geom_smooth(method = "lm", se = TRUE, color = "red", linewidth = 0.5) +
  labs(
    x = "	Number of new COVID cases",
    y = "	Number of patients on ventilators",
    title = "Number of patients on ventilators vs. \n Number of new COVID cases")+
  theme_minimal() 

```


```{r tbl-model-table}
#| echo: false
#| warning: false
#| message: false
#| tbl-cap: "Summary of Simple Linear Regression Model"
#| label: tbl-model-table

model_glance <- glance(covid_vents_mode)
model_tidy <- tidy(covid_vents_mode)%>%
  mutate(
    p.value = ifelse(p.value < 0.001, "<0.001", sprintf("%.3f", p.value))
    )
model_summary_table <- flextable(model_tidy) %>%
  add_header_lines(values = "Summary of Simple Linear Regression Model")%>%
  set_header_labels(
    term = "Variable",
    estimate = "Estimate",
    std.error = "Standard error",
    statistic = "T-value",
    p.value = "P-value"
  ) %>%
  colformat_num(j = c("estimate", "std.error", "statistic", "p.value"), digits = 3) %>%
  fontsize(size = 10, part = "all") %>%
  autofit() %>%
  add_footer_lines(values = paste(
    "Residual Standard Error:", round(model_glance$sigma, 1),
    "|R-squared:", round(model_glance$r.squared, 3),
    "| Adjusted R-squared:", round(model_glance$adj.r.squared, 3),
    "| F-statistic:", round(model_glance$statistic, 2)
  ))
model_summary_table

```

\newpage



# References
